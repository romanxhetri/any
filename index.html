<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Anymovie</title>
    <meta name="description" content="Anymovie is a Netflix-inspired streaming interface." />
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Babel Standalone -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind Config -->
    <script>
      tailwind.config = {
        theme: {
          extend: {
            colors: {
              netflixRed: '#E50914',
              netflixDark: '#141414',
              netflixGray: '#e5e5e5',
            },
            animation: {
              'fade-in': 'fadeIn 0.3s ease-in-out',
              'fade-in-up': 'fadeInUp 0.5s ease-out',
            },
            keyframes: {
              fadeIn: {
                '0%': { opacity: '0' },
                '100%': { opacity: '1' },
              },
              fadeInUp: {
                '0%': { opacity: '0', transform: 'translateY(20px)' },
                '100%': { opacity: '1' },
              }
            }
          },
        },
      }
    </script>

    <style>
      body {
        background-color: #141414;
        background-image: linear-gradient(to bottom, rgba(0, 0, 0, 0.6), rgba(0, 0, 0, 0.9)),
          url('https://img.freepik.com/free-photo/digital-painting-mountain-with-colorful-tree-foreground_1340-25699.jpg');
        background-size: cover;
        background-attachment: fixed;
        background-position: center;
        color: white;
        overflow-x: hidden;
        font-family: 'Helvetica Neue', Helvetica, Arial, sans-serif;
      }
      /* Custom Scrollbar */
      ::-webkit-scrollbar { width: 8px; height: 8px; }
      ::-webkit-scrollbar-track { background: #141414; }
      ::-webkit-scrollbar-thumb { background: #333; border-radius: 4px; }
      ::-webkit-scrollbar-thumb:hover { background: #555; }
      .no-scrollbar::-webkit-scrollbar { display: none; }
      .no-scrollbar { -ms-overflow-style: none; scrollbar-width: none; }
    </style>

    <!-- Import Map - FIXED: Removed conflicting React 19 imports -->
    <script type="importmap">
{
  "imports": {
    "react": "https://esm.sh/react@18.2.0",
    "react-dom/client": "https://esm.sh/react-dom@18.2.0/client",
    "lucide-react": "https://esm.sh/lucide-react@0.263.1",
    "react-dom/": "https://aistudiocdn.com/react-dom@^19.2.0/",
    "react/": "https://aistudiocdn.com/react@^19.2.0/"
  }
}
</script>
  </head>
  <body>
    <div id="root"></div>

    <script type="text/babel" data-type="module">
      import React, { useState, useEffect, useRef } from 'react';
      import ReactDOM from 'react-dom/client';
      import { Search, Bell, User, PlusCircle, Menu, X, Play, Info, Plus, ThumbsUp, ChevronDown, ChevronLeft, ChevronRight, Loader2, ArrowLeft, ExternalLink } from 'lucide-react';

      // --- DATA & CONSTANTS ---

      const getImg = (id, width = 600, height = 400) => `https://picsum.photos/seed/${id}/${width}/${height}`;

      const MOCK_HERO_MOVIE = {
        id: 'hero-1',
        title: 'Cyberpunk: Edgerunners',
        description: 'In a dystopia riddled with corruption and cybernetic implants, a talented but reckless street kid strives to become a mercenary outlaw â€” an edgerunner.',
        thumbnailUrl: getImg('cyberpunk', 1920, 1080),
        videoUrl: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/BigBuckBunny.mp4',
        genre: ['Sci-Fi', 'Anime'],
        matchScore: 98,
        year: 2022,
        rating: 'TV-MA',
        duration: '1 Season'
      };

      const generateMockMovies = (category, count) => {
        return Array.from({ length: count }).map((_, i) => ({
          id: `${category}-${i}`,
          title: `${category} Movie ${i + 1}`,
          description: `Description for ${category} Movie ${i + 1}.`,
          thumbnailUrl: getImg(`${category}${i}`),
          videoUrl: 'https://commondatastorage.googleapis.com/gtv-videos-bucket/sample/ElephantsDream.mp4',
          genre: [category, 'Drama'],
          matchScore: 85 + Math.floor(Math.random() * 15),
          year: 2020 + Math.floor(Math.random() * 4),
          rating: Math.random() > 0.5 ? 'TV-MA' : 'PG-13',
          duration: `${90 + Math.floor(Math.random() * 60)}m`
        }));
      };

      const INITIAL_CATEGORIES = [
        { 
          title: 'Trending Now', 
          movies: [
            {
                id: 'stranger-things-embed',
                title: 'Stranger Things',
                description: 'When a young boy disappears, a small town uncovers a mystery involving secret experiments, terrifying supernatural forces, and one strange little girl.',
                thumbnailUrl: 'https://picsum.photos/seed/strangerthings/600/400',
                embedUrl: 'https://dintezuvio.com/embed/hpow0ir439f7',
                genre: ['Sci-Fi', 'Horror', 'Drama'],
                matchScore: 99,
                year: 2016,
                rating: 'TV-14',
                duration: 'Series'
            },
            {
                id: 'predator-badlands-2025',
                title: 'Predator: Badlands',
                description: 'A new chapter in the Predator saga, set in a futuristic wasteland where survival is the only option.',
                thumbnailUrl: 'https://picsum.photos/seed/predatorbadlands/600/400',
                embedUrl: 'https://dintezuvio.com/embed/3searyff87wf',
                genre: ['Sci-Fi', 'Action'],
                matchScore: 97,
                year: 2025,
                rating: 'R',
                duration: 'Feature'
            },
            {
                id: 'last-samurai-standing',
                title: 'Last Samurai Standing',
                description: 'In a battle for honor and survival, the last warriors of a dying era face their greatest challenge yet.',
                thumbnailUrl: 'https://picsum.photos/seed/lastsamurai/600/400',
                embedUrl: 'https://dintezuvio.com/embed/0b982ger5u0n',
                genre: ['Action', 'History', 'Drama'],
                matchScore: 94,
                year: 2024,
                rating: 'TV-MA',
                duration: 'Season 1'
            },
            {
                id: 'aaryan-2025',
                title: 'Aaryan',
                description: 'An intense action thriller following a man on a quest for vengeance against a corrupt system.',
                thumbnailUrl: 'https://picsum.photos/seed/aaryan/600/400',
                embedUrl: 'https://dintezuvio.com/embed/8tqmb10ekaap',
                genre: ['Action', 'Thriller'],
                matchScore: 91,
                year: 2025,
                rating: 'NR',
                duration: 'Feature'
            },
            {
                id: 'primitive-war-2025',
                title: 'Primitive War',
                description: 'A rescue team in the Vietnam War encounters prehistoric horrors in the jungle.',
                thumbnailUrl: 'https://picsum.photos/seed/primitivewar/600/400',
                embedUrl: 'https://dintezuvio.com/embed/iyjhbog3hoqr',
                genre: ['Sci-Fi', 'Action'],
                matchScore: 98,
                year: 2025,
                rating: 'R',
                duration: 'Feature'
            },
            {
                id: 'dracula-love-tale',
                title: 'Dracula: A Love Tale',
                description: 'A fresh take on the legendary vampire story, exploring eternal love and darkness.',
                thumbnailUrl: 'https://picsum.photos/seed/draculalove/600/400',
                embedUrl: 'https://dintezuvio.com/embed/eqlwrgc8udk3',
                genre: ['Romance', 'Horror'],
                matchScore: 95,
                year: 2024,
                rating: 'TV-MA',
                duration: 'Feature'
            },
            {
                id: 'troll-1-embed',
                title: 'Troll 1',
                description: 'A young boy enters the forest and discovers a world of trolls.',
                thumbnailUrl: 'https://picsum.photos/seed/troll1/600/400',
                embedUrl: 'https://dintezuvio.com/embed/zmi9qnwhqic7',
                genre: ['Fantasy', 'Horror'],
                matchScore: 88,
                year: 1986,
                rating: 'PG-13',
                duration: '1h 26m'
            },
            {
                id: 'troll-2-embed',
                title: 'Troll 2',
                description: 'A family vacationing in a small town discovers the entire population is actually goblins in disguise who plan to eat them.',
                thumbnailUrl: 'https://picsum.photos/seed/troll2/600/400',
                embedUrl: 'https://dintezuvio.com/embed/la96qke5mit5',
                genre: ['Horror', 'Comedy'],
                matchScore: 92,
                year: 1990,
                rating: 'PG-13',
                duration: '1h 35m'
            },
            {
                id: 'pushpa-2-yt',
                title: 'Pushpa 2: The Rule',
                description: 'Pushpa 2: The Rule is an upcoming Indian Telugu-language action drama film written and directed by Sukumar.',
                thumbnailUrl: 'https://img.youtube.com/vi/uttNRhknNiY/maxresdefault.jpg',
                embedUrl: 'https://www.youtube-nocookie.com/embed/uttNRhknNiY?si=okxPEGJur2ueH7m3',
                genre: ['Action', 'Drama'],
                matchScore: 99,
                year: 2024,
                rating: 'UA',
                duration: 'Trailer'
            },
            ...generateMockMovies('trend', 5)
          ] 
        },
        { title: 'Top Rated for You', movies: generateMockMovies('top', 8) },
        { title: 'Sci-Fi Thrillers', movies: generateMockMovies('scifi', 8) },
        { title: 'Comedies', movies: generateMockMovies('comedy', 8) },
      ];

      // --- COMPONENTS ---

      const Navbar = ({ setViewState, onSearch, onOpenAddMovie }) => {
        const [isScrolled, setIsScrolled] = useState(false);
        const [showSearchInput, setShowSearchInput] = useState(false);
        const [searchQuery, setSearchQuery] = useState('');
        const [isMobileMenuOpen, setIsMobileMenuOpen] = useState(false);

        useEffect(() => {
          const handleScroll = () => setIsScrolled(window.scrollY > 0);
          window.addEventListener('scroll', handleScroll);
          return () => window.removeEventListener('scroll', handleScroll);
        }, []);

        const handleSearchSubmit = (e) => {
          e.preventDefault();
          if (searchQuery.trim()) {
            onSearch(searchQuery);
            setIsMobileMenuOpen(false);
            setShowSearchInput(false);
          }
        };

        return (
          <nav className={`fixed w-full z-50 transition-all duration-500 ${isScrolled || isMobileMenuOpen ? 'bg-netflixDark shadow-lg' : 'bg-gradient-to-b from-black via-black/80 to-transparent'}`}>
            <div className="px-4 md:px-12 py-3 md:py-4 flex items-center justify-between">
              <div className="flex items-center space-x-4 md:space-x-8">
                <button className="md:hidden text-white" onClick={() => setIsMobileMenuOpen(!isMobileMenuOpen)}>
                   {isMobileMenuOpen ? <X /> : <Menu />}
                </button>
                <button onClick={() => setViewState('HOME')} className="text-netflixRed text-2xl md:text-3xl font-bold tracking-tighter">
                  ANYMOVIE
                </button>
                <ul className="hidden md:flex space-x-5 text-sm font-medium text-gray-300">
                  <li onClick={() => setViewState('HOME')} className="hover:text-white cursor-pointer">Home</li>
                  <li className="hover:text-white cursor-pointer">TV Shows</li>
                  <li className="hover:text-white cursor-pointer">Movies</li>
                  <li className="hover:text-white cursor-pointer">My List</li>
                </ul>
              </div>

              <div className="flex items-center space-x-2 md:space-x-5 text-white">
                <form onSubmit={handleSearchSubmit} className={`flex items-center transition-all ${showSearchInput ? 'bg-black/80 border border-white' : ''} px-2 py-1`}>
                    <button type="button" onClick={() => setShowSearchInput(!showSearchInput)}>
                        <Search className="w-5 h-5" />
                    </button>
                    <input 
                        type="text" 
                        placeholder="Search..." 
                        className={`bg-transparent text-white text-sm ml-2 outline-none transition-all ${showSearchInput ? 'w-32 md:w-64 opacity-100' : 'w-0 opacity-0'}`}
                        value={searchQuery}
                        onChange={(e) => setSearchQuery(e.target.value)}
                    />
                </form>
                <button onClick={onOpenAddMovie} title="Add Movie">
                    <PlusCircle className="w-6 h-6" />
                </button>
                <Bell className="w-5 h-5 cursor-pointer" />
                <div className="w-8 h-8 rounded bg-blue-600 flex items-center justify-center"><User className="w-5 h-5" /></div>
              </div>
            </div>
            
            {/* Mobile Menu */}
            {isMobileMenuOpen && (
                <div className="md:hidden bg-netflixDark absolute top-16 left-0 w-full p-4 border-t border-gray-800">
                    <ul className="flex flex-col space-y-4 text-center text-gray-300">
                        <li onClick={() => { setViewState('HOME'); setIsMobileMenuOpen(false); }}>Home</li>
                        <li>TV Shows</li>
                        <li>Movies</li>
                        <li>My List</li>
                    </ul>
                </div>
            )}
          </nav>
        );
      };

      const Hero = ({ movie, onPlay }) => {
        return (
          <div className="relative w-full h-[80vh] md:h-[85vh] text-white overflow-hidden">
            <div className="absolute inset-0 w-full h-full">
              <img src={movie.thumbnailUrl} alt={movie.title} className="w-full h-full object-cover object-center" />
              <div className="absolute inset-0 bg-gradient-to-r from-black/80 via-black/40 to-transparent"></div>
              <div className="absolute bottom-0 left-0 right-0 h-48 md:h-96 bg-gradient-to-t from-[#141414] via-[#141414]/80 to-transparent"></div>
            </div>
            <div className="absolute top-[15%] md:top-[30%] left-4 md:left-12 max-w-[95%] md:max-w-2xl space-y-4 z-10">
              <h1 className="text-4xl md:text-7xl font-extrabold drop-shadow-2xl leading-tight">{movie.title}</h1>
              <div className="flex items-center space-x-4 text-green-400 font-semibold text-sm md:text-lg">
                  <span>{movie.matchScore}% Match</span>
                  <span className="text-gray-300">{movie.year}</span>
                  <span className="border border-gray-400 px-1 text-gray-200">{movie.rating}</span>
                  <span className="text-gray-300">{movie.duration}</span>
              </div>
              <p className="text-sm md:text-xl text-gray-100 drop-shadow-lg line-clamp-3 md:line-clamp-4 font-medium">{movie.description}</p>
              <div className="flex space-x-3 pt-4">
                <button onClick={onPlay} className="flex items-center px-5 py-2 md:px-7 md:py-3 bg-white text-black rounded font-bold hover:bg-gray-200 transition">
                  <Play className="w-5 h-5 md:w-7 md:h-7 mr-2 fill-black" /> Play
                </button>
                <button className="flex items-center px-5 py-2 md:px-7 md:py-3 bg-gray-500/70 text-white rounded font-bold backdrop-blur-sm hover:bg-gray-500/50">
                  <Info className="w-5 h-5 md:w-7 md:h-7 mr-2" /> More Info
                </button>
              </div>
            </div>
          </div>
        );
      };

      const MovieCard = ({ movie, onClick }) => (
        <div onClick={() => onClick(movie)} className="group relative bg-[#181818] rounded-md cursor-pointer transition-all duration-300 hover:z-50 md:hover:scale-110 shadow-lg flex-none w-[140px] md:w-[240px]">
          <div className="relative aspect-video w-full overflow-hidden rounded-md">
            <img src={movie.thumbnailUrl} alt={movie.title} className="object-cover w-full h-full rounded-md" loading="lazy" />
            <div className="md:hidden absolute bottom-0 left-0 right-0 p-2 bg-gradient-to-t from-black/90 to-transparent">
                <p className="text-white text-xs font-semibold truncate">{movie.title}</p>
            </div>
          </div>
          <div className="hidden md:block absolute top-full left-0 w-full bg-[#181818] p-3 rounded-b-md shadow-2xl opacity-0 group-hover:opacity-100 transition-opacity z-50 -mt-1">
             <div className="flex items-center space-x-2 mb-2">
                <div className="w-6 h-6 bg-white rounded-full flex items-center justify-center"><Play className="w-3 h-3 fill-black" /></div>
                <Plus className="w-4 h-4 text-gray-300" />
                <ThumbsUp className="w-4 h-4 text-gray-300" />
             </div>
             <p className="text-xs font-bold text-white mb-1">{movie.title}</p>
             <div className="flex text-[10px] text-gray-400 space-x-2">
                <span className="text-green-400">{movie.matchScore}% Match</span>
                <span>{movie.duration}</span>
             </div>
          </div>
        </div>
      );

      const Row = ({ title, movies, onMovieClick }) => {
        const rowRef = useRef(null);
        const slide = (offset) => { if(rowRef.current) rowRef.current.scrollBy({ left: offset, behavior: 'smooth' }); };

        return (
          <div className="space-y-2 py-4 relative group z-10">
            <h2 className="text-white text-lg md:text-2xl font-bold px-4 md:px-0">{title}</h2>
            <div className="relative">
              <ChevronLeft className="absolute left-0 top-0 bottom-0 z-40 m-auto w-10 h-full bg-black/50 hover:bg-black/70 cursor-pointer hidden md:block opacity-0 group-hover:opacity-100 transition" onClick={() => slide(-500)} />
              <div ref={rowRef} className="flex items-start space-x-3 md:space-x-4 overflow-x-auto no-scrollbar scroll-smooth px-4 md:px-0 pb-4">
                {movies.map(movie => <MovieCard key={movie.id} movie={movie} onClick={onMovieClick} />)}
              </div>
              <ChevronRight className="absolute right-0 top-0 bottom-0 z-40 m-auto w-10 h-full bg-black/50 hover:bg-black/70 cursor-pointer hidden md:block opacity-0 group-hover:opacity-100 transition" onClick={() => slide(500)} />
            </div>
          </div>
        );
      };

      const Player = ({ movie, onBack }) => {
        // SMART DETECTOR
        const isYouTube = movie.embedUrl && (
          movie.embedUrl.includes('youtube.com') || 
          movie.embedUrl.includes('youtu.be') ||
          movie.embedUrl.includes('youtube-nocookie.com')
        );
        
        // FIX for YouTube: NEEDS strict-origin to work.
        // FIX for 3rd Party: NEEDS no-referrer to work.
        const referrerPolicy = isYouTube ? "strict-origin-when-cross-origin" : "no-referrer";
        
        // CRITICAL FIX: Removed `sandbox` attribute entirely for 3rd party compatibility.
        // Added "Open in New Tab" button for fallback.

        const openInNewTab = () => {
            if (movie.embedUrl) window.open(movie.embedUrl, '_blank');
            else if (movie.videoUrl) window.open(movie.videoUrl, '_blank');
        };
        
        return (
          <div className="fixed inset-0 z-[100] bg-black flex flex-col">
            <div className="absolute top-0 left-0 w-full p-4 z-50 flex justify-between items-center bg-gradient-to-b from-black/70 to-transparent pointer-events-none">
              <button onClick={onBack} className="flex items-center text-white hover:text-gray-300 pointer-events-auto">
                <ArrowLeft className="w-8 h-8 mr-2" /> <span className="text-xl font-bold">Back</span>
              </button>
              
               <button onClick={openInNewTab} className="flex items-center bg-white/10 hover:bg-white/20 text-white px-4 py-2 rounded pointer-events-auto backdrop-blur-sm border border-white/20">
                <ExternalLink className="w-4 h-4 mr-2" />
                <span className="text-sm font-semibold">Open in New Tab</span>
              </button>
            </div>
            
            <div className="w-full h-full flex items-center justify-center">
              {movie.embedUrl ? (
                <iframe
                  src={movie.embedUrl}
                  className="w-full h-full border-0"
                  allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share; fullscreen; presentation"
                  allowFullScreen
                  referrerPolicy={referrerPolicy}
                ></iframe>
              ) : movie.videoUrl ? (
                <video controls autoPlay className="w-full h-full object-contain" src={movie.videoUrl} />
              ) : (
                <div className="text-white text-center">
                    <h2 className="text-2xl font-bold">No Video Source</h2>
                    <p>This movie does not have a valid video URL.</p>
                </div>
              )}
            </div>
          </div>
        );
      };

      const AddMovieModal = ({ onClose, onAdd }) => {
        const [formData, setFormData] = useState({ title: '', description: '', thumbnailUrl: '', videoUrl: '', embedUrl: '', genre: '' });

        const handleSubmit = (e) => {
          e.preventDefault();
          
          let finalEmbedUrl = formData.embedUrl;
          const iframeMatch = finalEmbedUrl.match(/src=["']?([^"'\s>]+)["']?/i);
          if (iframeMatch) {
            finalEmbedUrl = iframeMatch[1];
          }

          onAdd({
            id: `custom-${Date.now()}`,
            ...formData,
            embedUrl: finalEmbedUrl,
            thumbnailUrl: formData.thumbnailUrl || `https://picsum.photos/seed/${formData.title}/600/400`,
            genre: formData.genre.split(','),
            matchScore: 98, year: 2025, rating: 'NR', duration: 'Unknown'
          });
          onClose();
        };

        return (
          <div className="fixed inset-0 z-[100] flex items-center justify-center bg-black/80 p-4">
             <div className="bg-[#181818] w-full max-w-lg rounded-lg p-6 relative">
                <button onClick={onClose} className="absolute top-4 right-4 text-white"><X /></button>
                <h2 className="text-2xl font-bold text-white mb-4">Add Movie</h2>
                <form onSubmit={handleSubmit} className="space-y-3">
                    <input className="w-full bg-[#333] text-white p-2 rounded" placeholder="Title" required value={formData.title} onChange={e=>setFormData({...formData, title: e.target.value})} />
                    <textarea className="w-full bg-[#333] text-white p-2 rounded h-20" placeholder="Description" required value={formData.description} onChange={e=>setFormData({...formData, description: e.target.value})} />
                    <input className="w-full bg-[#333] text-white p-2 rounded" placeholder="Thumbnail URL" value={formData.thumbnailUrl} onChange={e=>setFormData({...formData, thumbnailUrl: e.target.value})} />
                    
                    <div className="border border-gray-600 p-2 rounded">
                        <p className="text-gray-300 text-sm mb-1 font-bold">Recommended: Direct MP4</p>
                        <input className="w-full bg-[#333] text-white p-2 rounded text-sm" placeholder="https://dropbox.../video.mp4?dl=1" value={formData.videoUrl} onChange={e=>setFormData({...formData, videoUrl: e.target.value})} />
                    </div>
                     <div className="border border-gray-600 p-2 rounded">
                        <p className="text-gray-300 text-sm mb-1">Or: Embed URL / Code</p>
                         <input className="w-full bg-[#333] text-white p-2 rounded text-sm" placeholder="Paste Link or <iframe src=...>" value={formData.embedUrl} onChange={e=>setFormData({...formData, embedUrl: e.target.value})} />
                    </div>
                    
                    <button type="submit" className="w-full bg-netflixRed text-white font-bold py-2 rounded">Add</button>
                </form>
             </div>
          </div>
        );
      };

      const Modal = ({ movie, onClose, onPlay }) => {
        if (!movie) return null;
        return (
           <div className="fixed inset-0 z-[90] flex items-center justify-center bg-black/80 p-4">
              <div className="fixed inset-0" onClick={onClose}></div>
              <div className="bg-[#181818] w-full max-w-4xl rounded-lg overflow-hidden relative z-10 shadow-2xl">
                 <button onClick={onClose} className="absolute top-4 right-4 z-50 bg-[#181818] rounded-full p-1 text-white"><X /></button>
                 <div className="relative h-64 md:h-96">
                    <img src={movie.thumbnailUrl} className="w-full h-full object-cover" />
                    <div className="absolute inset-0 bg-gradient-to-t from-[#181818] via-transparent to-transparent"></div>
                    <div className="absolute bottom-8 left-8">
                        <h2 className="text-4xl font-bold text-white mb-4">{movie.title}</h2>
                        <button onClick={onPlay} className="flex items-center px-6 py-2 bg-white text-black font-bold rounded hover:bg-gray-200">
                            <Play className="w-5 h-5 mr-2 fill-black" /> Play
                        </button>
                    </div>
                 </div>
                 <div className="p-8 text-white grid md:grid-cols-3 gap-8">
                    <div className="md:col-span-2 space-y-4">
                        <div className="flex space-x-4 font-semibold text-green-400">
                            <span>{movie.matchScore}% Match</span>
                            <span className="text-gray-300">{movie.year}</span>
                            <span className="text-gray-300">{movie.duration}</span>
                        </div>
                        <p className="text-gray-300">{movie.description}</p>
                    </div>
                    <div>
                        <span className="text-gray-500">Genres:</span> {movie.genre.join(', ')}
                    </div>
                 </div>
              </div>
           </div>
        );
      };

      const App = () => {
        const [viewState, setViewState] = useState('HOME');
        const [selectedMovie, setSelectedMovie] = useState(null);
        const [playingMovie, setPlayingMovie] = useState(null);
        const [searchResults, setSearchResults] = useState([]);
        const [searchQuery, setSearchQuery] = useState('');
        const [myMovies, setMyMovies] = useState([]);
        const [isAddModalOpen, setIsAddModalOpen] = useState(false);

        const handleSearch = (query) => {
            setSearchQuery(query);
            setViewState('SEARCH');
            const allMovies = [MOCK_HERO_MOVIE, ...INITIAL_CATEGORIES.flatMap(c=>c.movies), ...myMovies];
            setSearchResults(allMovies.filter(m => m.title.toLowerCase().includes(query.toLowerCase())));
        };

        const handlePlayMovie = (movie) => {
            setPlayingMovie(movie);
            setViewState('PLAYER');
            setSelectedMovie(null);
        };

        const handleMovieClick = (movie) => {
            setSelectedMovie(movie);
        };

        const handleCloseModal = () => {
            setSelectedMovie(null);
        };

        if (viewState === 'PLAYER' && playingMovie) {
            return <Player movie={playingMovie} onBack={() => { setViewState('HOME'); setPlayingMovie(null); }} />;
        }

        return (
          <div className="min-h-screen pb-10">
            <Navbar setViewState={setViewState} onSearch={handleSearch} onOpenAddMovie={() => setIsAddModalOpen(true)} />
            
            {viewState === 'HOME' && (
              <>
                <Hero movie={MOCK_HERO_MOVIE} onPlay={() => handlePlayMovie(MOCK_HERO_MOVIE)} />
                <div className="relative z-10 mt-0 md:-mt-32 space-y-8 pl-4 md:pl-12 pb-10 bg-gradient-to-t from-[#141414] via-transparent to-transparent">
                    {myMovies.length > 0 && <Row title="My List" movies={myMovies} onMovieClick={setSelectedMovie} />}
                    {INITIAL_CATEGORIES.map(cat => (
                        <Row key={cat.title} title={cat.title} movies={cat.movies} onMovieClick={setSelectedMovie} />
                    ))}
                </div>
              </>
            )}

            {viewState === 'SEARCH' && (
                <div className="pt-24 px-12 min-h-screen">
                    <h2 className="text-2xl text-white mb-6">Results for "{searchQuery}"</h2>
                    <div className="grid grid-cols-2 md:grid-cols-5 gap-4">
                        {searchResults.map(m => (
                            <div key={m.id} className="cursor-pointer" onClick={() => setSelectedMovie(m)}>
                                <img src={m.thumbnailUrl} className="rounded-md hover:scale-105 transition duration-300" />
                                <p className="text-white text-sm mt-2 font-bold">{m.title}</p>
                            </div>
                        ))}
                    </div>
                </div>
            )}

            <div className="text-center text-gray-500 text-xs py-8 border-t border-gray-800 mt-10">
                Created by Hari Chaulagain
            </div>

            <Modal movie={selectedMovie} onClose={handleCloseModal} onPlay={() => handlePlayMovie(selectedMovie)} />
            {isAddModalOpen && <AddMovieModal onClose={() => setIsAddModalOpen(false)} onAdd={(m) => setMyMovies([m, ...myMovies])} />}
          </div>
        );
      };

      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(<App />);
    </script>
  </body>
</html>